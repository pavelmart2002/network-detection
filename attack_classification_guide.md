# Система классификации атак в WAIDPS

## 1. Типы атак и их характеристики

### Deauthentication Attack (Атака деаутентификации)
**Уровень опасности**: HIGH
**Описание**: Атакующий отправляет пакеты деаутентификации, разрывая соединение между клиентом и точкой доступа.
**Признаки**:
- Большое количество пакетов деаутентификации (>10 в секунду)
- Один источник отправляет пакеты множеству получателей
- Периодические разрывы соединения

**Последствия**:
- Отключение клиентов от сети
- Возможность перехвата WPA handshake
- Нарушение работы сети

### Beacon Flood Attack (Флуд маяковыми фреймами)
**Уровень опасности**: MEDIUM
**Описание**: Атакующий отправляет множество поддельных beacon-фреймов, создавая видимость большого количества сетей.
**Признаки**:
- Слишком частые beacon-фреймы (интервал <0.1 сек)
- Множество сетей с похожими SSID
- Аномальное количество точек доступа

**Последствия**:
- Замедление работы клиентских устройств
- Затруднение поиска легитимных сетей
- Возможные сбои в работе устройств

### Authentication Flood (Флуд аутентификацией)
**Уровень опасности**: MEDIUM
**Описание**: Массовая отправка запросов на аутентификацию к точке доступа.
**Признаки**:
- Большое количество запросов аутентификации (>50 в секунду)
- Запросы от одного источника
- Неполные процессы аутентификации

**Последствия**:
- Перегрузка точки доступа
- Отказ в обслуживании легитимным клиентам
- Истощение ресурсов

### Probe Request Flood (Флуд probe-запросами)
**Уровень опасности**: LOW
**Описание**: Массовая отправка probe-запросов для поиска сетей.
**Признаки**:
- Большое количество probe-запросов (>100 в секунду)
- Запросы к несуществующим сетям
- Постоянное сканирование

**Последствия**:
- Увеличение сетевого шума
- Возможное раскрытие скрытых сетей
- Нагрузка на точки доступа

### Evil Twin Attack (Атака двойника)
**Уровень опасности**: CRITICAL
**Описание**: Создание поддельной точки доступа, имитирующей легитимную.
**Признаки**:
- Одинаковый ESSID с разными BSSID
- Отличия в параметрах сети (канал, шифрование)
- Подозрительно сильный сигнал

**Последствия**:
- Перехват пользовательского трафика
- Кража учетных данных
- Компрометация безопасности

### WPS Brute Force Attack (Атака на WPS)
**Уровень опасности**: HIGH
**Описание**: Попытка подбора PIN-кода WPS.
**Признаки**:
- Множественные WPS-транзакции
- Повторяющиеся попытки (>15)
- Систематический перебор

**Последствия**:
- Получение доступа к сети
- Компрометация WPA ключа
- Блокировка WPS

## 2. Механизм обнаружения

### Анализ пакетов
```python
def analyze_packet(self, packet_data):
    # Определение типа пакета
    if 'Deauth' in packet_data:
        self._analyze_deauth(...)
    elif 'Authentication' in packet_data:
        self._analyze_auth(...)
    elif 'Probe Request' in packet_data:
        self._analyze_probe(...)
    elif 'Beacon' in packet_data:
        self._analyze_beacon(...)
```

### Пороговые значения
```python
thresholds = {
    'deauth_packets': 10,   # Деаутентификация
    'auth_packets': 50,     # Аутентификация
    'probe_packets': 100,   # Probe-запросы
    'beacon_interval': 0.1  # Beacon-фреймы
}
```

### Счетчики и метрики
- Количество пакетов в единицу времени
- Интервалы между пакетами
- Соотношение типов пакетов
- Аномалии в параметрах

## 3. Уровни опасности

### CRITICAL (Критический)
- Требует немедленного реагирования
- Прямая угроза безопасности
- Возможна компрометация данных
- Например: Evil Twin Attack

### HIGH (Высокий)
- Требует быстрого реагирования
- Существенное влияние на работу
- Возможны серьезные последствия
- Например: Deauthentication Attack

### MEDIUM (Средний)
- Требует внимания
- Возможны помехи в работе
- Ограниченное влияние
- Например: Authentication Flood

### LOW (Низкий)
- Требует наблюдения
- Минимальное влияние
- Потенциальная угроза
- Например: Probe Request Flood

## 4. Реагирование на атаки

### Автоматические действия
1. Логирование инцидента
2. Уведомление пользователя
3. Обновление счетчиков
4. Сбор доказательств

### Рекомендуемые действия
1. **Для CRITICAL**:
   - Немедленная блокировка источника
   - Оповещение администратора
   - Сбор полной информации

2. **Для HIGH**:
   - Активное противодействие
   - Мониторинг источника
   - Подготовка отчета

3. **Для MEDIUM**:
   - Усиленный мониторинг
   - Подготовка контрмер
   - Анализ тенденций

4. **Для LOW**:
   - Запись в лог
   - Накопление статистики
   - Периодический анализ

## 5. Настройка и оптимизация

### Тонкая настройка порогов
```python
# Пример настройки для разных окружений
thresholds_office = {
    'deauth_packets': 5,    # Строже
    'auth_packets': 30,     # Строже
    'probe_packets': 50,    # Строже
    'beacon_interval': 0.2  # Мягче
}

thresholds_public = {
    'deauth_packets': 20,   # Мягче
    'auth_packets': 100,    # Мягче
    'probe_packets': 200,   # Мягче
    'beacon_interval': 0.05 # Строже
}
```

### Рекомендации по настройке
1. Учитывать размер сети
2. Учитывать количество клиентов
3. Учитывать тип окружения
4. Периодически корректировать

## 6. Отчетность

### Формат отчета об атаке
```python
attack_report = {
    'type': AttackType.DEAUTH,
    'severity': AttackSeverity.HIGH,
    'timestamp': '2024-01-19 16:30:45',
    'source': '00:11:22:33:44:55',
    'target': 'ff:ff:ff:ff:ff:ff',
    'details': {
        'packet_count': 150,
        'duration': '00:02:30',
        'affected_clients': 5
    }
}
```

### Статистика и анализ
1. Количество атак по типам
2. Распределение по уровням опасности
3. Временные паттерны
4. Эффективность обнаружения
