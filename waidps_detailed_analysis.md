# Детальный анализ WAIDPS (WiFi Auditor & IDS/IPS)

## 1. Системные компоненты и импорты

### 1.1 Основные импорты
```python
import __builtin__
import os,sys,subprocess,getopt,glob
import time,datetime
import tty,termios,curses
import select
import signal
import random
import urllib
import shutil
import re
import readline
import threading
```

Назначение каждого импорта:
- `__builtin__`: Доступ к встроенным функциям Python
- `os, sys`: Взаимодействие с операционной системой
- `subprocess`: Запуск внешних процессов и команд
- `getopt`: Обработка аргументов командной строки
- `glob`: Поиск файлов по шаблонам
- `time, datetime`: Работа со временем и датами
- `tty, termios, curses`: Управление терминалом
- `select`: Мультиплексирование ввода/вывода
- `signal`: Обработка системных сигналов
- `threading`: Многопоточность

## 2. Цветовое оформление (Класс fcolor)

### 2.1 Основные цветовые коды
```python
Class fcolor:
    CReset='\033[0m'      # Сброс всех атрибутов
    CBold='\033[1m'       # Жирный текст
    CDim='\033[2m'        # Тусклый текст
    CUnderline='\033[4m'  # Подчёркнутый текст
    CBlink='\033[5m'      # Мигающий текст
```

### 2.2 Цветовая палитра
- Стандартные цвета (Black, Red, Green, Yellow, Blue, Pink, Cyan, White)
- Яркие цвета (BBlack, BRed, BGreen, BYellow, BBlue, BPink, BCyan, BWhite)
- Подчёркнутые цвета (UBlack, URed, UGreen, UYellow, UBlue, UPink, UCyan, UWhite)
- Фоновые цвета (BGBlack, BGRed, BGGreen, BGYellow, BGBlue, BGPink, BGCyan, BGWhite)

## 3. Функции мониторинга сети

### 3.1 MonitorAccessPoint(TargetMAC, Auto)
Основная функция мониторинга точки доступа:
- Параметры:
  - `TargetMAC`: MAC-адрес целевой точки доступа
  - `Auto`: Флаг автоматического режима
- Функционал:
  - Мониторинг трафика точки доступа
  - Обнаружение подключенных клиентов
  - Анализ типов пакетов
  - Обнаружение атак
  - Логирование активности

### 3.2 DisplayAPDetail()
Отображение информации о точках доступа:
- Показывает:
  - SSID (имя сети)
  - MAC-адрес
  - Канал
  - Тип шифрования
  - Мощность сигнала
  - Производителя (по OUI)
  - Статус WPS
  - Количество клиентов

### 3.3 DisplayStationDetail()
Информация о подключенных устройствах:
- Отображает:
  - MAC-адреса клиентов
  - Точки доступа, к которым подключены
  - Производителя устройства
  - Типы отправляемых пакетов
  - Время последней активности

## 4. Функции атак и тестирования

### 4.1 AttackWPAProc(TargetMAC, TargetChannel, ClientList, Auto)
Процесс атаки на WPA:
- Этапы:
  1. Деаутентификация клиентов
  2. Захват рукопожатия
  3. Попытка взлома ключа
  4. Сохранение результатов
- Параметры:
  - `TargetMAC`: MAC-адрес цели
  - `TargetChannel`: Рабочий канал
  - `ClientList`: Список клиентов
  - `Auto`: Автоматический режим

### 4.2 AttackWPSProc(TargetMAC, TargetChannel, ClientList, Auto)
Атака на WPS:
- Методы:
  1. Pixie Dust атака
  2. Bruteforce PIN
  3. Null PIN атака
  4. Custom PIN атака
- Защита от блокировки
- Сохранение успешных попыток

### 4.3 AttackWEPProc(TargetMAC, TargetChannel, ClientList)
Атаки на WEP:
- Типы атак:
  1. ARP Replay
  2. Chop-Chop
  3. Fragmentation
  4. Caffe Latte
- Сбор IV (Initialization Vectors)
- Статистический анализ

### 4.4 Fake_Auth(TargetMAC, FName)
Фальшивая аутентификация:
- Создание поддельных пакетов
- Эмуляция клиента
- Обход MAC-фильтрации
- Сбор информации о сети

## 5. Функции аудита безопасности

### 5.1 OptAuditing(HeaderLine)
Комплексный аудит:
- Проверки:
  1. Тип шифрования
  2. Наличие WPS
  3. Сила сигнала
  4. Скрытый SSID
  5. MAC-фильтрация
  6. Наличие клиентов
- Генерация отчетов
- Рекомендации по безопасности

### 5.2 CheckHandshake(capfile, TargetMAC, ESSID)
Анализ рукопожатий:
- Проверка целостности
- Извлечение параметров
- Подготовка к взлому
- Валидация EAPOL пакетов

## 6. Работа с базой данных

### 6.1 DisplayCrackDB()
Просмотр базы данных:
- Информация:
  - Взломанные сети
  - Использованные методы
  - Найденные ключи
  - Временные метки
  - Статус WPS

### 6.2 AddCrackDB(BSSID, Enc, EncKey, ESSID, HS_File, WPS, Ignore)
Добавление записей:
- Параметры:
  - `BSSID`: MAC-адрес точки доступа
  - `Enc`: Тип шифрования
  - `EncKey`: Найденный ключ
  - `ESSID`: Имя сети
  - `HS_File`: Файл рукопожатия
  - `WPS`: Статус WPS
  - `Ignore`: Флаг игнорирования

## 7. Вспомогательные функции

### 7.1 printc(PrintType, PrintText, PrintText2)
Форматированный вывод:
- Типы вывода:
  - Информационные сообщения
  - Предупреждения
  - Ошибки
  - Успешные операции
- Цветовое кодирование
- Временные метки

### 7.2 LookupMAC(sMACAddr)
Поиск информации по MAC:
- Определение производителя
- Проверка в базе данных
- История обнаружений
- Связанные устройства

### 7.3 ChangeMACAddr(IFace, IFace2, IFace3)
Управление MAC-адресами:
- Изменение MAC
- Проверка валидности
- Восстановление оригинала
- Работа с несколькими интерфейсами

## 8. Функции защиты и обнаружения атак

### 8.1 Обнаружение MDK атак
- Типы атак:
  1. Beacon Flooding
  2. Authentication DoS
  3. WIDS/WIPS Confusion
  4. WPA Downgrade

### 8.2 Защитные механизмы
- Белый список устройств
- Логирование атак
- Оповещения
- Автоматическое блокирование

## 9. Утилиты и инструменты

### 9.1 LogMonFile(DataStr)
Система логирования:
- Форматы логов:
  - Текстовый
  - PCAP
  - CSV
- Ротация логов
- Фильтрация данных

### 9.2 DisplayCapturedPacket(PK_File)
Анализ пакетов:
- Декодирование
- Фильтрация
- Статистика
- Экспорт данных

## 10. Рекомендации по использованию

### 10.1 Требования
- Root-права
- Совместимое оборудование
- Зависимости:
  - aircrack-ng
  - reaver
  - mdk3
  - wash

### 10.2 Безопасность
- Только для тестовых сред
- Соблюдение законодательства
- Документирование действий
- Ответственное использование

### 10.3 Ограничения
- Зависимость от оборудования
- Возможные ложные срабатывания
- Нагрузка на систему
- Совместимость с драйверами

## 11. Заключение

WAIDPS представляет собой мощный инструмент для:
1. Аудита WiFi сетей
2. Обнаружения атак
3. Тестирования безопасности
4. Мониторинга сетевой активности

Требует глубокого понимания:
- Сетевых протоколов
- Безопасности WiFi
- Linux-систем
- Инструментов пентеста
